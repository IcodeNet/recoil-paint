(this["webpackJsonprecoil-paint"]=this["webpackJsonprecoil-paint"]||[]).push([[0],{55:function(e,t,n){e.exports=n(91)},91:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),o=n.n(c),l=n(24),i=n(13),u=n(3),s=n(93),d=n(7),h=n(22),b=n(1),f=n(94);function m(e){var t=e.x,n=e.y,a=e.width,c=e.height,o=e.fill,l=e.label,i=e.style,u=e.onMouseDown,d=e.onClick;return r.a.createElement(s.a,{style:[v.root,{top:n,left:t,width:a,height:c,backgroundColor:o},i],onMouseDown:u,onClick:d},l?r.a.createElement(f.a,null,l):null)}var v=d.a.create({root:{position:"absolute",justifyContent:"center",alignItems:"center"}});var g=d.a.create({root:{}});var y=d.a.create({root:{borderRadius:"50%"}}),j={rect:function(e){return r.a.createElement(m,Object.assign({},e,{style:g.root}))},ellipse:function(e){return r.a.createElement(m,Object.assign({},e,{style:y.root}))}};var O=1;var w={x:0,y:0};var E=Object(b.atom)({key:"itemIdsState",default:[]}),p=Object(b.atom)({key:"selectedIdsState",default:[]}),x=Object(b.atom)({key:"movingItemIdsState",default:[]}),S=Object(b.atom)({key:"movingItemsSnapshotState",default:{}}),k=Object(b.atom)({key:"canvasLayoutState",default:{x:0,y:0,width:800,height:600}}),R=function(e){var t=new Map;return function(n){if(t.has(n))return t.get(n);for(var a=arguments.length,r=new Array(a>1?a-1:0),c=1;c<a;c++)r[c-1]=arguments[c];var o=e.apply(void 0,[n].concat(r));return t.set(n,o),o}}((function(e){return Object(b.atom)({key:"item".concat(e),default:{type:"rect",id:e,x:w.x,y:w.y,width:200,height:100,fill:"#dbdde4",label:""}})}));function M(e,t){return Object(b.selector)({key:e,get:function(e){var n=e.get,a=n(t);return a.length?a.map((function(e){return n(R(e))})):[]},set:function(e,t){var n=e.set;t.forEach((function(e){var t=e.id;n(R(t),e)}))}})}var C=M("selectedItemsSelector",p),I=M("movingItemsSelector",x),D=M("allItemsSelector",E),L=Object(b.selector)({key:"selectionBoundingBox",get:function(e){return function(e){if(!e.length)return null;var t=null,n=null,a=null,r=null;return e.forEach((function(e){(null===t||e.x<t)&&(t=e.x),(null===a||e.y<a)&&(a=e.y),(null===n||e.x+e.width>n)&&(n=e.x+e.width),(null===r||e.y+e.height>r)&&(r=e.y+e.height)})),{x:t,y:a,width:n-t,height:r-a,isMutilple:e.length>1}}((0,e.get)(C))}});function V(e){var t=e.id,n=Object(b.useRecoilValue)(R(t)),a=function(e){var t=e.type;return j[t]}(n);return a?r.a.createElement(a,n):null}function z(e){var t=Object(a.useState)(!1),n=Object(u.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)({clientX:0,clientY:0}),l=Object(u.a)(o,2),i=l[0],s=l[1],d=Object(a.useState)({x:0,y:0}),h=Object(u.a)(d,2),b=h[0],f=h[1],m=Object(a.useCallback)((function(t,n,a,r){e({status:t,isMoving:n,origin:a,offset:r})}),[e]),v=Object(a.useCallback)((function(e){var t={clientX:e.clientX,clientY:e.clientY};c(!0),s(t),m("start",!0,t,b)}),[m,b]),g=Object(a.useCallback)((function(e){var t=e.clientX,n=e.clientY;if(r){var a={x:t-i.clientX,y:n-i.clientY};f(a),m("moving",!0,i,a)}}),[m,r,i]),y=Object(a.useCallback)((function(){r&&(c(!1),f({x:0,y:0}),m("end",!1,i,b))}),[m,r,b,i]);return Object(a.useEffect)((function(){function e(){window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",y)}return r?(window.addEventListener("mousemove",g),window.addEventListener("mouseup",y)):e(),e}),[g,y,r]),{onMouseDown:v}}function W(){var e=Object(b.useRecoilState)(C),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(null),l=Object(u.a)(o,2),d=l[0],h=l[1],f=z((function(e){var t=e.status,a=e.offset;1===n.length&&("start"===t&&h(n),"moving"===t&&c(d.map((function(e){return function(e,t){var n=e.x,a=e.y,r=e.width,c=e.height;return(r+=t.x)<0&&(n-=r=-r),(c+=t.y)<0&&(a-=c=-c),Object(i.a)(Object(i.a)({},e),{},{x:n,y:a,width:r,height:c})}(e,a)}))))})).onMouseDown;if(1!==n.length)return null;var m=n[0],v=m.x,g=m.y,y=m.width,j=m.height;return r.a.createElement(s.a,{style:[X.resizeHandler,{left:v+y,top:g+j}],onMouseDown:f},r.a.createElement(s.a,{style:X.resizeHandlerDot}))}var X=d.a.create({resizeHandler:{width:24,height:24,marginLeft:-13,marginTop:-13,justifyContent:"center",alignItems:"center",cursor:"nwse-resize"},resizeHandlerDot:{width:10,height:10,borderRadius:4,backgroundColor:"white",borderWidth:2,borderColor:"blue",position:"absolute"}});function Y(){var e=Object(b.useRecoilValue)(p),t=Object(b.useRecoilValue)(L),n=Object(b.useSetRecoilState)(x),a=z((function(a){var r=a.status;if(!t)return null;"start"===r&&n(e),"end"===r&&n([])})).onMouseDown;if(!t)return null;var c=t.x,o=t.y,l=t.width,i=t.height;return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{style:[B.selection,{left:c,top:o,width:l,height:i}],onMouseDown:a}),r.a.createElement(W,null))}var B=d.a.create({selection:{borderWidth:2,borderStyle:"dashed",borderColor:"blue",position:"absolute",cursor:"move"}});function H(){var e=Object(a.useRef)(),t=Object(b.useRecoilValue)(E),n=Object(b.useRecoilState)(k),c=Object(u.a)(n,2),o=c[0],l=c[1],i=Object(b.useRecoilState)(p),d=Object(u.a)(i,2),f=d[0],m=d[1],v=Object(b.useRecoilValue)(D),g=Object(a.useCallback)((function(e){for(var t,n=e.clientX,a=e.clientY,r=e.metaKey,c=e.shiftKey,l=n-o.x,i=a-o.y,u=null,s=v.length-1;s>=0;s--){var d=v[s];if(l>=d.x&&l<=d.x+d.width&&i>=d.y&&i<=d.y+d.height){u=d;break}}t=u?r||c?[].concat(Object(h.a)(f),[u.id]):[u.id]:[],m(t)}),[v,o.x,o.y,f,m]);return r.a.createElement(s.a,{style:Z.root,ref:e,onLayout:function(e){var t=e.nativeEvent.layout,n=t.x,a=t.y,r=t.width,c=t.height;return l({x:n,y:a,width:r,height:c})},onClick:g},t.map((function(e){return r.a.createElement(V,{key:"item-".concat(e),id:e})})),r.a.createElement(Y,null))}var Z=d.a.create({root:{flex:1,backgroundColor:"white"},svg:{flex:1}}),T=n(54);function A(e){var t=e.Icon,n=e.disabled,a=e.style,c=Object(T.a)(e,["Icon","disabled","style"]);return r.a.createElement(s.a,Object.assign({accessibilityRole:"button",disabled:n,style:[J.root,n&&J.disabled,a]},c),r.a.createElement(t,{style:[n&&J.disabledIcon]}))}var J=d.a.create({root:{borderWidth:1,borderColor:"#ccc",backgroundColor:"#fff",width:32,height:32,justifyContent:"center",alignItems:"center",borderRadius:4},disabled:{cursor:"default",opacity:.8},disabledIcon:{fill:"#ccc"}}),K=n(23);function F(e){var t=e.ariaLabel,n=e.children,a=e.width,r=e.height,c=e.viewBox,o=[P.root,e.style];return Object(K.a)("svg",{role:"presentation",width:a,height:r,"aria-label":t,style:o,viewBox:c||"0 0 24 24"},n)}F.defaultProps={width:24,height:24};var P=d.a.create({root:{display:"inline-block",fill:"currentcolor",height:"1.25em",maxWidth:"100%",position:"relative",userSelect:"none",textAlignVertical:"text-bottom"},iconRtl:{transform:[{scaleX:-1}]}});function $(e){return r.a.createElement(F,e,r.a.createElement("g",null,r.a.createElement("path",{d:"M19.235,1.75H4.765c-1.662,0-3.015,1.352-3.015,3.015v14.471c0,1.662,1.352,3.015,3.015,3.015h14.471  c1.662,0,3.015-1.352,3.015-3.015V4.765C22.25,3.102,20.898,1.75,19.235,1.75z M21.044,19.235c0,0.997-0.811,1.809-1.809,1.809  H4.765c-0.997,0-1.809-0.811-1.809-1.809v-2.181l4.866-5.407l6.573,5.975l3.635-3.029l3.015,2.512V19.235z M21.044,15.536  l-3.015-2.512l-3.601,3L7.737,9.94l-4.781,5.312V4.765c0-0.997,0.811-1.809,1.809-1.809h14.471c0.997,0,1.809,0.811,1.809,1.809  V15.536z"}),r.a.createElement("path",{d:"M16.221,10.794c1.662,0,3.015-1.352,3.015-3.015s-1.352-3.015-3.015-3.015c-1.662,0-3.015,1.352-3.015,3.015  S14.558,10.794,16.221,10.794z M16.221,5.971c0.997,0,1.809,0.811,1.809,1.809s-0.811,1.809-1.809,1.809s-1.809-0.811-1.809-1.809  S15.223,5.971,16.221,5.971z"})))}function q(e){return r.a.createElement(F,e,r.a.createElement("g",{transform:"matrix(.48 0 0 .48 0 0)"},r.a.createElement("path",{fill:"#000",d:"M44 1h-38c-2.757 0-5 2.243-5 5v38c0 2.757 2.243 5 5 5h38c2.757 0 5-2.243 5-5v-38c0-2.757-2.243-5-5-5Zm3 43c0 1.654-1.346 3-3 3h-38c-1.654 0-3-1.346-3-3v-38c0-1.654 1.346-3 3-3h38c1.654 0 3 1.346 3 3v38Z"})))}function G(e){var t=e.style,n=Object(b.useRecoilState)(E),a=Object(u.a)(n,2),c=a[0],o=a[1],l=Object(b.useRecoilState)(x),i=Object(u.a)(l,2),s=i[0],d=i[1],f=Object(b.useSetRecoilState)(p),m=Object(b.useRecoilValue)(k),v=z((function(e){var t,n,a=e.status,r=e.origin;e.offset,e.isMoving;if("start"===a){var l=O++;t=r.clientX-m.x,n=r.clientY-m.y,Object.assign(w,{x:t,y:n}),o([].concat(Object(h.a)(c),[l])),f([]),d([l])}"end"===a&&(f(Object(h.a)(s)),d([]))})).onMouseDown;return r.a.createElement(A,{Icon:q,style:t,onMouseDown:v})}function N(e){return r.a.createElement(F,e,r.a.createElement("g",{transform:"matrix(.380952 0 0 .380952 0 0)"},r.a.createElement("path",{d:"M10 9h-8c-1.104 0-2 .896-2 2v40c0 1.104.896 2 2 2h8c1.104 0 2-.896 2-2v-40c0-1.104-.896-2-2-2Z"}),r.a.createElement("path",{d:"M27.833 23h-8c-1.104 0-2.833.11-2.833.864v27.273c0 .753 1.729 1.863 2.833 1.863h8c1.105 0 1.167-1.11 1.167-1.863v-27.273c0-.754-.062-.864-1.167-.864Z"}),r.a.createElement("path",{d:"M44.5 12h-8c-1.104 0-2.5.334-2.5 1.364v37.273c0 1.029 1.396 2.363 2.5 2.363h8c1.104 0 1.5-1.334 1.5-2.363v-37.273c0-1.03-.396-1.364-1.5-1.364Z"}),r.a.createElement("path",{d:"M61.5 37h-8c-1.104 0-2.5-.175-2.5.228v14.545c0 .402 1.396 1.227 2.5 1.227h8c1.104 0 1.5-.825 1.5-1.228v-14.544c0-.403-.396-.228-1.5-.228Z"})))}function Q(){return r.a.createElement(s.a,{style:U.root},r.a.createElement(G,{style:U.button}),r.a.createElement(A,{disabled:!0,Icon:$,style:U.button}),r.a.createElement(A,{disabled:!0,Icon:N,style:U.button}))}var U=d.a.create({root:{flexDirection:"row"},button:{marginRight:8}});function _(){var e=Object(b.useRecoilState)(I),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(b.useRecoilState)(S),d=Object(u.a)(o,2),h=d[0],f=d[1],m=Object(b.useRecoilValue)(x),v=z((function(e){var t=e.status,a=e.offset;e.origin;"moving"===t&&m.length&&c(n.map((function(e){var t=h[e.id];return t?Object(i.a)(Object(i.a)({},t),{},{x:t.x+a.x,y:t.y+a.y}):e})))})).onMouseDown;return Object(a.useEffect)((function(){f(n.reduce((function(e,t){return Object.assign(e,Object(l.a)({},t.id,t))}),{}))}),[m]),r.a.createElement(s.a,{style:ee.root,onMouseDown:v},r.a.createElement(s.a,{style:ee.left},r.a.createElement(Q,null)),r.a.createElement(H,null),r.a.createElement(s.a,{style:ee.right}))}var ee=d.a.create({root:{height:"100vh",flexDirection:"row",backgroundColor:"#ebeef2"},left:{width:240,borderRightWidth:1,borderRightColor:"#ccc",borderRightType:"solid",padding:16},right:{width:200,borderLeftWidth:1,borderLeftColor:"#ccc",borderLeftType:"solid"}});var te=function(){return r.a.createElement(b.RecoilRoot,null,r.a.createElement(_,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[55,1,2]]]);
//# sourceMappingURL=main.1fa4e592.chunk.js.map